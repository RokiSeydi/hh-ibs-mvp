<!DOCTYPE html>
<html>
  <head>
    <title>Google Sheets Test</title>
  </head>
  <body>
    <h1>Test Google Sheets Connection</h1>

    <form id="testForm">
      <input
        type="text"
        name="firstName"
        placeholder="First Name"
        value="Test"
        required
      /><br /><br />
      <input
        type="text"
        name="lastName"
        placeholder="Last Name"
        value="User"
        required
      /><br /><br />
      <input
        type="email"
        name="email"
        placeholder="Email"
        value="test@example.com"
        required
      /><br /><br />
      <select name="reason" required>
        <option value="just-curious">Just Curious</option>
        <option value="going-through-something">
          Going Through Something
        </option></select
      ><br /><br />
      <button type="submit">Test Submit</button>
    </form>

    <div id="result"></div>

    <script>
      document
        .getElementById("testForm")
        .addEventListener("submit", async function (e) {
          e.preventDefault();

          const resultDiv = document.getElementById("result");
          resultDiv.innerHTML = "Submitting...";

          const formData = new FormData(this);
          formData.append("timestamp", new Date().toISOString());

          try {
            const response = await fetch(
              "https://script.google.com/macros/s/AKfycbxkHY053w1TXg4IYmMXL2w0zCfhRwdr-pqANjbJC-DHRPBTZ7NGcYaEHzXnuW7v9xM-/exec",
              {
                method: "POST",
                body: formData,
              }
            );

            console.log("Response status:", response.status);
            const text = await response.text();
            console.log("Response text:", text);

            try {
              const json = JSON.parse(text);
              resultDiv.innerHTML = `<pre>${JSON.stringify(
                json,
                null,
                2
              )}</pre>`;
            } catch {
              resultDiv.innerHTML = `<pre>Response: ${text}</pre>`;
            }
          } catch (error) {
            console.error("Error:", error);
            resultDiv.innerHTML = `<pre>Error: ${error.message}</pre>`;
          }
        });
    </script>
  </body>
</html>
